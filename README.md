# Wimi API client

This PHP package is a client for the [Wimi](https://www.wimi-teamwork.com/) API. 
Please refer to the [official API documentation](https://pegasus.wimi.pro/wapi-doc-api).

Every target implementation is automatically generated, please see "Generate request classes" section down below to learn more.

## Requirements

- PHP 8.1 and above

## Installation

```sh
composer require praftr/wimi-api-client
```

## Usage

```php
<?php

require 'vendor/autoload.php';

use Praftr\WimiApiClient\ApiClient;
use Praftr\WimiApiClient\Request\Main\Account\GetProjectsRequest;

$accountId = 1;
$userId = 1;

$apiClient = new ApiClient('account_name', 'username', 'password', 'app_token');
$apiClient->handle(new GetProjectsRequest($accountId, $userId)); // ['projects' => ['project_id: 1, ...
```

Optionally, you can override the HTTP client with any implementation of 
[psr/http-client](https://github.com/php-fig/http-client).

For instance using [Symfony HttpClient component](https://github.com/symfony/http-client)

```sh
composer require symfony/http-client
```

```php
<?php

require 'vendor/autoload.php';

use Symfony\Component\HttpClient\Psr18Client;
use Praftr\WimiApiClient\ApiClient;

$httpClient = new Psr18Client();
$apiClient = new ApiClient('account_name', 'username', 'password', 'app_token', $httpClient);
```

Default is [Guzzle](https://github.com/guzzle/guzzle)

## Generate request classes

Every class in Request directory (except Abstract and Interface) is automatically generated by scrapping and 
parsing the online API documentation.

The code that generates classes can be found under `src/Generator/`.

Feel free to test it out and submit a PR if you notice any update in the API documentation.

**First, delete generated request classes**

```sh
php bin/generate_requests.php
```

## Test

```sh
php ./vendor/bin/phpunit
```

## Code analysis

```sh
php tools/php-cs-fixer/vendor/bin/php-cs-fixer --config=.php-cs-fixer.php.dist --allow-risky=yes fix
```

## License

This package is made available under the MIT License (MIT). Please see License File for more information.
